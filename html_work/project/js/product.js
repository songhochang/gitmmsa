const productsData = {
  1: [
    {
      name: "통밀빵",
      image: "../img/bread/1.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "무화과 깜빠뉴",
      image: "../img/bread/2.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "호밀빵",
      image: "../img/bread/3.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
      new: "item_new",
    },
    {
      name: "크림치즈 깜빠뉴",
      image: "../img/bread/4.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "허니 월넛 브레드",
      image: "../img/bread/5.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "메론빵",
      image: "../img/bread/6.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "페이스트리",
      image: "../img/bread/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "견과 곡물 브레드",
      image: "../img/bread/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "연유 바게트",
      image: "../img/bread/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
      new: "item_new",
    },
    {
      name: "소금빵",
      image: "../img/bread/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
  ],
  2: [
    {
      name: "리치 생크링 케이크",
      image: "../img/cake/1.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
      new: "item_new"
    },
    {
      name: "시나몬 과일 케이크",
      image: "../img/cake/2.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "초코 무스 케이크",
      image: "../img/cake/3.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "젤리 케이크",
      image: "../img/cake/4.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "이벤트 케이크",
      image: "../img/cake/5.jpg",
      description: "짜지 않는 고소함",
      kind: "cake",
    },
    {
      name: "파티 케이크",
      image: "../img/cake/6.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "팬 크림 케이크",
      image: "../img/cake/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
      new: "item_new",
    },
    {
      name: "화이트 초코 케이크",
      image: "../img/cake/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "민트 초코 케이크",
      image: "../img/cake/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "초코 무스 케이크",
      image: "../img/cake/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
  ],
  3: [
    {
      name: "생크림 컵케이크",
      image: "../img/dessert/1.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "미니 케이크",
      image: "../img/dessert/2.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "미니 초코케이크",
      image: "../img/dessert/3.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
      new: "item_new",
    },
    {
      name: "커피크림 번",
      image: "../img/dessert/4.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "과일 조각케이크",
      image: "../img/Dessert/5.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "푸딩",
      image: "../img/dessert/6.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "카라멜 디저트",
      image: "../img/dessert/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "커스터드 푸딩",
      image: "../img/dessert/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
      new: "item_new",
    },
    {
      name: "치즈 조각케이크",
      image: "../img/dessert/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "치즈 조각케이크2",
      image: "../img/dessert/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
  ],
  4: [
    {
      name: "햄치즈샌드위치",
      image: "../img/sandwich/1.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "플랫샌드위치",
      image: "../img/sandwich/2.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "클럽샌드위치",
      image: "../img/sandwich/3.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "바게트 살라미 샌드",
      image: "../img/sandwich/4.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
      new: "item_new",
    },
    {
      name: "이탈리안BMT",
      image: "../img/sandwich/5.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "베이컨치즈더블",
      image: "../img/sandwich/6.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "오리지날 토스트",
      image: "../img/sandwich/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
      new: "item_new",
    },
    {
      name: "더블 치즈토스트",
      image: "../img/sandwich/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "맥스치킨토스트",
      image: "../img/sandwich/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "불고기치즈더블",
      image: "../img/sandwich/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
  ],
};

const recommendedProductsLeftData = {
  1: [
    {
      name: "소금빵",
      image: "../img/bread/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
  ],
  2: [
    {
      name: "말차에 퐁당 딸기케이크",
      image: "../img/cake/2.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
  ],
  3: [
    {
      name: "쿠키생크림 조합",
      image: "../img/dessert/1.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
  ],
  4: [
    {
      name: "햄치즈 샌드위치",
      image: "../img/sandwich/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
  ],
};

const recommendedProductsRightData = {
  1: [
    {
      name: "티라미수 생크림",
      image: "../img/bread/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "해피 복숭아 케이크",
      image: "../img/bread/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "사르르 샤사핑",
      image: "../img/bread/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
    {
      name: "올스타 케이크",
      image: "../img/bread/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Bread",
    },
  ],
  2: [
    {
      name: "티라미수 생크림",
      image: "../img/cake/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "해피 복숭아 케이크",
      image: "../img/cake/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "사르르 샤사핑",
      image: "../img/cake/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
    {
      name: "올스타 케이크",
      image: "../img/cake/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Cake",
    },
  ],
  3: [
    {
      name: "티라미수 생크림",
      image: "../img/dessert/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "해피 복숭아 케이크",
      image: "../img/dessert/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "사르르 샤사핑",
      image: "../img/dessert/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
    {
      name: "올스타 케이크",
      image: "../img/dessert/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Dessert",
    },
  ],
  4: [
    {
      name: "티라미수 생크림",
      image: "../img/sandwich/7.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "해피 복숭아 케이크",
      image: "../img/sandwich/8.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "사르르 샤사핑",
      image: "../img/sandwich/9.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
    {
      name: "올스타 케이크",
      image: "../img/sandwich/10.jpg",
      description: "짜지 않는 고소함",
      kind: "Sandwich",
    },
  ],
};

let recommendedProductLeftSideRender = document.querySelector(
  ".recommended_left_area"
);
let recommendedProductRightSideRender = document.querySelector(
  ".recommended_right_area"
);
let productRender = document.querySelector(".product_rendering");

export function renderRecommendedProducts(categoryId) {
  /* common structure
    li              .recommended_item_wrap
    -- a    
    ---- span       .img
    ------ img          src
    ---- span       .info
    ------ span         .name
    ------ span         .txt_shape
   */
  eraseProducts(recommendedProductLeftSideRender);
  eraseProducts(recommendedProductRightSideRender);

  /* left side */
  drawRecommendedProducts(
    recommendedProductLeftSideRender,
    recommendedProductsLeftData,
    categoryId
  );

  /* right side */
  drawRecommendedProducts(
    recommendedProductRightSideRender,
    recommendedProductsRightData,
    categoryId
  );
}

export function renderProducts(categoryId) {
      /*
        product DOM structure

        li
        -- a        .item_best
        ---- span       .item_text
        ---- img        .item_img 
        ---- span       .item_info
        ------ span         .name
        ------ span         .txt_shape
        ------ span         .item_new
    */
  
  // 기존 컨텐츠 지우기
  eraseProducts(productRender);

  const products = productsData[categoryId];

    // 템플릿 리터럴 사용하여 HTML 생성
    const productHTML = products.map(product => `
      <li class="item">
        <a class="item_best">
          <span class="item_text">${product.name}</span>
          <img class="item_img" src="${product.image}" alt="${product.name}">
          <span class="item_info">
            <span class="name">${product.description}</span>
            <span class="txt_shape">${product.kind}</span>
            ${product.new ? `<span class="${product.new}"></span>` : ''}
          </span>
        </a>
      </li>
    `).join('');

  // DOM에 한 번에 추가
  productRender.innerHTML = productHTML;

  // Longer text slice
  const itemTexts = document.querySelectorAll(".product_rendering .item_text");
  itemTexts.forEach((itemText) => doTextSlice(itemText, 160));

  // box-shadow changed
  const itemList = document.querySelectorAll(".product_rendering .item a");
  itemList.forEach((item) => {
    item.style.boxShadow = `2px 2px 8px 2px rgba(${255 - categoryId * 20}, ${
      180 - categoryId * 20
    }, ${41 + categoryId * 20}, 0.9)`;
  });
}

function doTextSlice(element, maxWidth) {
  let text = element.innerText;

  // offsetWidth = width + padding + margin;
  while (element.offsetWidth > maxWidth) {
    text = text.slice(0, -1);
    element.innerText = text + "..";
  }
}

function drawRecommendedProducts(renderProduct, productsData, categoryId) {
  const products = productsData[categoryId];

  const recommendedProductsHTML = products.map(product => `
    <li class="recommended_item_wrap">
      <a href="#"> <span class="img">
          <img src="${product.image}" alt="${product.name}">
        </span>
        <span class="info">
          <span class="name">${product.name}</span>
          <span class="txt_shape">${product.kind}</span>
        </span>
      </a>
    </li>
  `).join('');
  
  renderProduct.innerHTML = recommendedProductsHTML;
}

function eraseProducts(parent) {
  while (parent.firstChild) {
    parent.removeChild(parent.firstChild);
  }
}
